(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3986:function(e,t,o){Promise.resolve().then(o.bind(o,2406)),Promise.resolve().then(o.t.bind(o,3445,23)),Promise.resolve().then(o.t.bind(o,2445,23)),Promise.resolve().then(o.bind(o,5925))},2406:function(e,t,o){"use strict";o.r(t),o.d(t,{AuthProvider:function(){return c},useAuth:function(){return u}});var r=o(7437),n=o(2265),a=o(826),s=o(5925);let l=(0,n.createContext)(void 0);function c(e){let{children:t}=e,[o,c]=(0,n.useState)(null),[u,i]=(0,n.useState)(null),[d,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("presence_token");e?(i(e),a.h.defaults.headers.common.Authorization="Bearer ".concat(e),f()):h(!1)},[]);let f=async()=>{try{let e=await a.h.get("/auth/profile");c(e.data)}catch(e){console.error("Erro ao buscar perfil:",e),localStorage.removeItem("presence_token"),i(null),c(null)}finally{h(!1)}},m=async(e,t)=>{try{h(!0);let{token:o,user:r}=(await a.h.post("/auth/login",{email:e,password:t})).data;localStorage.setItem("presence_token",o),i(o),c(r),a.h.defaults.headers.common.Authorization="Bearer ".concat(o),s.default.success("Login realizado com sucesso!")}catch(t){var o,r;let e=(null===(r=t.response)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.message)||"Erro ao fazer login";throw s.default.error(e),t}finally{h(!1)}},v=async(e,t,o,r)=>{try{h(!0);let{token:n,user:l}=(await a.h.post("/auth/register",{name:e,email:t,password:o,phone:r})).data;localStorage.setItem("presence_token",n),i(n),c(l),a.h.defaults.headers.common.Authorization="Bearer ".concat(n),s.default.success("Conta criada com sucesso!")}catch(t){var n,l;let e=(null===(l=t.response)||void 0===l?void 0:null===(n=l.data)||void 0===n?void 0:n.message)||"Erro ao criar conta";throw s.default.error(e),t}finally{h(!1)}};return(0,r.jsx)(l.Provider,{value:{user:o,token:u,login:m,register:v,logout:()=>{localStorage.removeItem("presence_token"),i(null),c(null),delete a.h.defaults.headers.common.Authorization,s.default.success("Logout realizado com sucesso!")},isLoading:d,isAuthenticated:!!o&&!!u},children:t})}function u(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}},826:function(e,t,o){"use strict";o.d(t,{h:function(){return r}});let r=o(4829).Z.create({baseURL:"http://localhost:3001/api",timeout:1e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{let t=localStorage.getItem("presence_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("presence_token"),window.location.href="/login"),Promise.reject(e)})},2445:function(){},3445:function(e){e.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}}},function(e){e.O(0,[916,971,938,744],function(){return e(e.s=3986)}),_N_E=e.O()}]);